

<% 
    case section
      when :personal_details
        validator = PersonalDetailForm
        confirmation_view = Trainees::Confirmation::PersonalDetails::View
      when :contact_details
        validator = ContactDetailForm
        confirmation_view = Trainees::Confirmation::ContactDetails::View
      when :diversity
        validator = Diversities::FormValidator
        confirmation_view = Trainees::Confirmation::Diversity::View
      when :degrees
        validator = DegreeDetailForm
        confirmation_view = Trainees::Confirmation::Degrees::View
      when :programme_details
        validator = ProgrammeDetailForm
        confirmation_view = Trainees::Confirmation::ProgrammeDetails::View
    end

    status = ProgressService.call(
          validator: validator.new(trainee),
          progress_value: trainee.progress.public_send(section)
        ).status

    # TODO: hunt down status and change it to symbol 
    status = status.parameterize(separator: '_').to_sym
%>

<% if status == :completed %>
  <%= render confirmation_view.new(trainee: trainee) %>
<% else %>
  <%= render MissingDetails::View.new(section: section, progress: status, trainee: trainee) %>
<% end %>
